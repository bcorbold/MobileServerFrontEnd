<div fxFlex class="ms-incoming-batches-container" ngClass.gt-sm="ms-desktop-batches" ngClass.lt-md="ms-mobile-batches" fxLayout="column">
  <h1 fxShow fxHide.lt-md class="ms-header">Incoming Batches</h1>

  <div fxFlex style="overflow: auto">
    <div *ngFor="let batch of batches">
      <div class="ms-batch-container" fxLayout="column" fxLayoutAlign="start stretch">
        <div *ngFor="let order of batch.orders">
          <div fxLayout="row" fxLayoutAlign="start stretch" (click)="updateOrderStatus(order, batch)"
               [ngClass]="{ 'pointer-row': batch.state !== 'Delivering',
                              'order-sent': batch.state === 'Delivering',
                              'order-ready': order.ready && batch.state !== 'Delivering',
                              'order-not-ready': !order.ready  && batch.state !== 'Delivering' }">

            <!-- todo: have a think about how to replace the tooltip for accessibility for mobile users -->
            <div class="state-indicator" matTooltip="{{batch.state}}" matTooltipPosition="after"></div>
            <div fxFlex fxLayout="column" fxLayoutAlign="start stretch" style="margin: 0.5em;">
              <div fxLayout="row">
                <p fxFlex="50" style="margin-right: 0.5em;">{{order.orderInfo.orderOption.name}}</p>
                <div fxFlex="50">
                  <span style="margin-right: 0.25em;">Delivering too:</span>
                  <span class="light-text">{{order.deliveryLocation.name}}</span>
                </div>
              </div>
              <div fxLayout="row">
                <div fxFlex="50" style="margin-right: 0.5em;">
                  <mat-chip-list *ngIf="order.orderInfo?.selectedAddOns && order.orderInfo.selectedAddOns.length !== 0">
                    <div *ngFor="let addOn of order.orderInfo.selectedAddOns">
                      <mat-chip>{{addOn.key}}{{addOn.value === 'true' ? '' : ', ' + addOn.value}}</mat-chip>
                    </div>
                  </mat-chip-list>
                </div>
                <div fxFlex="50" *ngIf="order.state !== 'Delivered'" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                  <span style="margin-right: 0.25em;">Order ETA:</span>
                  <span class="light-text">{{order.deliveryEta}}</span>
                </div>
                <div fxFlex="50" *ngIf="order.state === 'Delivered'" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                  <span style="margin-right: 0.25em;">Ordered on:</span>
                  <span class="light-text">{{order.orderDate}}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
        <button *ngIf="batch.state !== 'Delivering' && batch.ready" mat-raised-button color="accent" (click)="sendBatch(batch)">Send with <i>{{batch.assignedRobot.name}}</i></button>
      </div>
    </div>
    <p *ngIf="batches.length === 0"><i>No batches available.</i></p>
  </div>
</div>
