<div fxFill class="ms-order-history-wrapper" fxLayout="column">
  <h1 class="ms-header">Order History</h1>

  <div fxFlex class="ms-order-history-container" fxLayout="column">
    <div *ngFor="let order of orderHistory;">
      <div class="order-row" fxLayout="row" fxLayoutAlign="start stretch">

        <!-- todo: add a tool tip to the color bar for state information -->
        <div class="state-color-bar" [ngClass]="{waiting: order.state === 'Waiting' || order.state === 'Queued', delivering: order.state === 'Delivering', delivered: order.state === 'Delivered', delayed: order.state === 'Delayed'}"></div>
        <div fxFlex class="row-info" fxLayout="row" fxLayoutAlign="start stretch">
          <div fxFlex="30" fxLayout="column">
            <p>{{order.orderInfo.orderOption.name}}</p>
            <mat-chip-list>
              <div *ngFor="let addOn of order.orderInfo.selectedAddOns">
                <mat-chip>{{addOn.key}}, {{addOn.value}}</mat-chip>
              </div>
            </mat-chip-list>
          </div>

          <div fxFlex *ngIf="order.state !== 'Delivered'" fxLayout="row">
            <div fxFlex fxLayout="column" fxLayoutAlign="start stretch">
              <p>Delivering too:</p>
              <p class="light-text">{{order.deliveryLocation.name}}</p>
            </div>

            <!-- todo: Once time estimates are finished add/test -->
            <div fxFlex fxLayout="column" fxLayoutAlign="start stretch">
              <p>Estimated time till arrival:</p>
              <p class="light-text">
                <!--<ms-date-time-formatter [date]="order.deliveryEta" [formatAsDate]="false" [timeTooEstimate]="true"></ms-date-time-formatter>-->
              </p>
            </div>
          </div>

          <div fxFlex *ngIf="order.state === 'Delivered'">
            <div fxFlex fxLayout="column" fxLayoutAlign="start stretch">
              <p>Ordered on:</p>
              <p class="light-text">
                <!--<ms-date-time-formatter [date]="order.orderDate"></ms-date-time-formatter>-->
              </p>
            </div>

            <div fxFlex fxLayout="column" fxLayoutAlign="start stretch">
              <p>Delivered on:</p>
              <p class="light-text">
                <!-- todo: need to add this back in once BE sends back date -->
                <!--<ms-date-time-formatter [date]="order.deliveredDate"></ms-date-time-formatter>-->
              </p>
            </div>
          </div>

          <button mat-button (click)="reorder.emit(order)" color="accent">Reorder</button>
        </div>
      </div>
    </div>
    <div *ngIf="orderHistory.length === 0"><i>No past orders to be displayed... Try ordering something!</i></div>
  </div>
</div>
